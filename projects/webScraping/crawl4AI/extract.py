import asyncio
from crawl4ai import AsyncWebCrawler , BrowserConfig , CrawlerRunConfig , CacheMode
from bs4 import BeautifulSoup
import uuid



urls = ['https://react.dev/', 'https://react.dev/versions', 'https://react.dev/learn', 'https://react.dev/reference/react', 'https://react.dev/community']

# urls = ['https://react.dev/', 'https://react.dev/versions', 'https://react.dev/learn', 'https://react.dev/reference/react', 'https://react.dev/community', 'https://react.dev/blog', 'https://react.dev/community/translations', 'https://react.dev/learn/add-react-to-an-existing-project', 'https://react.dev/learn/start-a-new-react-project', 'https://react.dev/blog/2024/12/05/react-19', 'https://react.dev/blog/2024/10/21/react-compiler-beta-release', 'https://react.dev/blog/2024/05/22/react-conf-2024-recap', 'https://react.dev/learn/installation', 'https://react.dev/learn/describing-the-ui', 'https://react.dev/learn/adding-interactivity', 'https://react.dev/learn/managing-state', 'https://react.dev/learn/escape-hatches', 'https://react.dev/reference/react-dom', 'https://react.dev/community/team', 'https://react.dev/community/docs-contributors', 'https://react.dev/community/acknowledgements', 'https://react.dev/reference/react/components', 'https://react.dev/reference/react/apis', 'https://react.dev/reference/react/legacy', 'https://react.dev/reference/react-dom/components', 'https://react.dev/reference/react-dom/client', 'https://react.dev/reference/react-dom/server', 'https://react.dev/community/versioning-policy', 'https://react.dev/blog/2023/03/16/introducing-react-dev', 'https://react.dev/blog/2024/04/25/react-19-upgrade-guide', 'https://react.dev/blog/2022/03/29/react-v18', 'https://react.dev/blog/2022/03/08/react-18-upgrade-guide', 'https://react.dev/blog/2021/06/08/the-plan-for-react-18', 'https://react.dev/learn/tutorial-tic-tac-toe', 'https://react.dev/learn/thinking-in-react', 'https://react.dev/learn/editor-setup', 'https://react.dev/learn/typescript', 'https://react.dev/learn/react-developer-tools', 'https://react.dev/learn/react-compiler', 'https://react.dev/learn/your-first-component', 'https://react.dev/learn/importing-and-exporting-components', 'https://react.dev/learn/writing-markup-with-jsx', 'https://react.dev/learn/javascript-in-jsx-with-curly-braces', 'https://react.dev/learn/passing-props-to-a-component', 'https://react.dev/learn/conditional-rendering', 'https://react.dev/learn/rendering-lists', 'https://react.dev/learn/keeping-components-pure', 'https://react.dev/learn/understanding-your-ui-as-a-tree', 'https://react.dev/learn/responding-to-events', 'https://react.dev/learn/state-a-components-memory', 'https://react.dev/learn/render-and-commit', 'https://react.dev/learn/state-as-a-snapshot', 'https://react.dev/learn/queueing-a-series-of-state-updates', 'https://react.dev/learn/updating-objects-in-state', 'https://react.dev/learn/updating-arrays-in-state', 'https://react.dev/learn/reacting-to-input-with-state', 'https://react.dev/learn/choosing-the-state-structure', 'https://react.dev/learn/sharing-state-between-components', 'https://react.dev/learn/preserving-and-resetting-state', 'https://react.dev/learn/extracting-state-logic-into-a-reducer', 'https://react.dev/learn/passing-data-deeply-with-context', 'https://react.dev/learn/scaling-up-with-reducer-and-context', 'https://react.dev/learn/referencing-values-with-refs', 'https://react.dev/learn/manipulating-the-dom-with-refs', 'https://react.dev/learn/synchronizing-with-effects', 'https://react.dev/learn/you-might-not-need-an-effect', 'https://react.dev/learn/lifecycle-of-reactive-effects', 'https://react.dev/learn/separating-events-from-effects', 'https://react.dev/learn/removing-effect-dependencies', 'https://react.dev/learn/reusing-logic-with-custom-hooks', 'https://react.dev/reference/react/useState', 'https://react.dev/reference/react/hooks', 'https://react.dev/reference/react/useActionState', 'https://react.dev/reference/react/useCallback', 'https://react.dev/reference/react/useContext', 'https://react.dev/reference/react/useDebugValue', 'https://react.dev/reference/react/useDeferredValue', 'https://react.dev/reference/react/useEffect', 'https://react.dev/reference/react/useId', 'https://react.dev/reference/react/useImperativeHandle', 'https://react.dev/reference/react/useInsertionEffect', 'https://react.dev/reference/react/useLayoutEffect', 'https://react.dev/reference/react/useMemo', 'https://react.dev/reference/react/useOptimistic', 'https://react.dev/reference/react/useReducer', 'https://react.dev/reference/react/useRef', 'https://react.dev/reference/react/useSyncExternalStore', 'https://react.dev/reference/react/useTransition', 'https://react.dev/reference/react/Fragment', 'https://react.dev/reference/react/Profiler', 'https://react.dev/reference/react/StrictMode', 'https://react.dev/reference/react/Suspense', 'https://react.dev/reference/react/act', 'https://react.dev/reference/react/cache', 'https://react.dev/reference/react/createContext', 'https://react.dev/reference/react/lazy', 'https://react.dev/reference/react/memo', 'https://react.dev/reference/react/startTransition', 'https://react.dev/reference/react/use', 'https://react.dev/reference/react/experimental_taintObjectReference', 'https://react.dev/reference/react/experimental_taintUniqueValue', 'https://react.dev/reference/react-dom/hooks', 'https://react.dev/reference/react-dom/hooks/useFormStatus', 'https://react.dev/reference/react-dom/components/common', 'https://react.dev/reference/react-dom/components/form', 'https://react.dev/reference/react-dom/components/input', 'https://react.dev/reference/react-dom/components/option', 'https://react.dev/reference/react-dom/components/progress', 'https://react.dev/reference/react-dom/components/select', 'https://react.dev/reference/react-dom/components/textarea', 'https://react.dev/reference/react-dom/components/link', 'https://react.dev/reference/react-dom/components/meta', 'https://react.dev/reference/react-dom/components/script', 'https://react.dev/reference/react-dom/components/style', 'https://react.dev/reference/react-dom/components/title', 'https://react.dev/reference/react-dom/createPortal', 'https://react.dev/reference/react-dom/flushSync', 'https://react.dev/reference/react-dom/preconnect', 'https://react.dev/reference/react-dom/prefetchDNS', 'https://react.dev/reference/react-dom/preinit', 'https://react.dev/reference/react-dom/preinitModule', 'https://react.dev/reference/react-dom/preload', 'https://react.dev/reference/react-dom/preloadModule', 'https://react.dev/reference/react-dom/client/createRoot', 'https://react.dev/reference/react-dom/client/hydrateRoot', 'https://react.dev/reference/react-dom/server/renderToPipeableStream', 'https://react.dev/reference/react-dom/server/renderToReadableStream', 'https://react.dev/reference/react-dom/server/renderToStaticMarkup', 'https://react.dev/reference/react-dom/server/renderToString', 'https://react.dev/reference/react-dom/static', 'https://react.dev/reference/react-dom/static/prerender', 'https://react.dev/reference/react-dom/static/prerenderToNodeStream', 'https://react.dev/reference/rules', 'https://react.dev/reference/rules/components-and-hooks-must-be-pure', 'https://react.dev/reference/rules/react-calls-components-and-hooks', 'https://react.dev/reference/rules/rules-of-hooks', 'https://react.dev/reference/rsc/server-components', 'https://react.dev/reference/rsc/server-functions', 'https://react.dev/reference/rsc/directives', 'https://react.dev/reference/rsc/use-client', 'https://react.dev/reference/rsc/use-server', 'https://react.dev/reference/react/Children', 'https://react.dev/reference/react/cloneElement', 'https://react.dev/reference/react/Component', 'https://react.dev/reference/react/createElement', 'https://react.dev/reference/react/createRef', 'https://react.dev/reference/react/forwardRef', 'https://react.dev/reference/react/isValidElement', 'https://react.dev/reference/react/PureComponent', 'https://react.dev/community/conferences', 'https://react.dev/community/meetups', 'https://react.dev/community/videos', 'https://react.dev/blog/2024/02/15/react-labs-what-we-have-been-working-on-february-2024', 'https://react.dev/blog/2023/05/03/react-canaries', 'https://react.dev/blog/2023/03/22/react-labs-what-we-have-been-working-on-march-2023', 'https://react.dev/blog/2022/06/15/react-labs-what-we-have-been-working-on-june-2022', 'https://react.dev/blog/2021/12/17/react-conf-2021-recap', 'https://react.dev/blog/2020/12/21/data-fetching-with-react-server-components', 'https://react.dev/reference/react/experimental_useEffectEvent']

async def main():
    browser_config = BrowserConfig(headless=True, verbose=False)
    run_config = CrawlerRunConfig(
        cache_mode=CacheMode.BYPASS
    )

    name = str(uuid.uuid4())
    print(f"Processing a total of: {len(urls)}'s")
    count = 0
    async with AsyncWebCrawler(config=browser_config) as crawler:
        results = await crawler.arun_many(
            urls=urls,
            config=run_config
        )
        
        for result in results:
            if result.success:
                count+=1
                # soup = BeautifulSoup(result.html, 'html.parser')
                print(f"Processed {count}/{len(urls)}, Markdown length: {len(result.markdown)}")
                
                with open(name + ".md", "a" , encoding="utf-8") as f:
                    f.write(result.markdown)

            else:
                print(f"Failed to crawl {result.url}: {result.error_message}")

asyncio.run(main())